NODE_CTL=replicactl
SERVICES=mongod/true/tcp:{{getv "/env/port"}}
MY_IP={{getv "/host/ip"}}
DATA_MOUNTS=/data

APPCTL_ENV=

GLOBAL_UUID={{getv "/cluster/global_uuid"}}
MONGODB_CONF_PATH="/opt/app/current/conf/mongodb"
MONGODB_OLDCONF_FILE="/data/appctl/data/mongodb.conf.old"
MONGODB_USER_SYS="qc_master"
MONGODB_USER_ROOT="root"
MONGODB_USER_CUSTOM={{getv "/env/user"}}
MONGODB_USER_PASSWD={{getv "/env/passwd"}}

MY_SID={{getv "/host/sid"}}
MY_PORT={{getv "/env/port"}}
RSNAME={{getv "/env/rsName"}}
NODE_LIST=(
    {{- range $dir := lsdir "/hosts/replica" -}}
    {{- $sid := printf "/hosts/replica/%s/sid" $dir -}}
    {{- $ip := printf "/hosts/replica/%s/ip" $dir -}}
    {{- $node_id := printf "/hosts/replica/%s/node_id" $dir -}}
    '{{getv $sid}}|{{getv $ip}}|{{getv $node_id}}' {{print}}
    {{- end -}})

{{- $dir := ls "/adding-hosts" -}}
{{- $len := len $dir -}}
{{- if gt $len 0}}
ADDING_HOSTS=true
ADDING_LIST=(
    {{- range $dir := lsdir "/adding-hosts/replica" -}}
    {{- $sid := printf "/adding-hosts/replica/%s/sid" $dir -}}
    {{- $ip := printf "/adding-hosts/replica/%s/ip" $dir -}}
    '{{getv $sid}}|{{getv $ip}}' {{print}}
    {{- end -}})
{{- else}}
ADDING_HOSTS=false
{{- end -}}

{{- $dir := ls "/deleting-hosts" -}}
{{- $len := len $dir -}}
{{- if gt $len 0}}
DELETING_HOSTS=true
DELETING_LIST=(
    {{- range $dir := lsdir "/deleting-hosts/replica" -}}
    {{- $sid := printf "/deleting-hosts/replica/%s/sid" $dir -}}
    {{- $ip := printf "/deleting-hosts/replica/%s/ip" $dir -}}
    '{{getv $sid}}|{{getv $ip}}' {{print}}
    {{- end -}})
{{- else}}
DELETING_HOSTS=false
{{- end}}
MONGODB_MAXCONNS={{getv "/env/maxConns"}}
MONGODB_OPLOGSIZE={{getv "/env/oplogSize"}}
MONGODB_MAINTAIN_PORT=33044